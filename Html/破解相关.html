原文链接：http://www.cnblogs.com/kexing/archive/2018/02/11/8028019.html
<p>Android逆向破解之Smali篇<br />Dalvik跳转指令：<br />先附上完整的Dalvik跳转指令：<br />if-eq vx, vy, 目标 如果vx == vy注2，跳转到目标。<br />if-ne vx,vy, 目标 如果vx != vy注2，跳转到目标。 <br />if-lt vx,vy, 目标 如果vx &lt; vy注2，跳转到目标。 <br />if-ge vx, vy, 目标 如果vx &gt;= vy注2，跳转到目标。 <br />if-gt vx,vy, 目标 如果vx &gt; vy注2，跳转到目标。 <br />if-le vx,vy, 目标 如果vx &lt;= vy注2，跳转到目标。 <br />if-eqz vx, 目标 如果vx == 0注2，跳转到目标。 <br />if-nez vx, 目标 如果vx != 0注2，跳转到目标。<br />if-ltz vx, 目标 如果vx &lt; 0注2，跳转到目标。<br />if-gez vx, 目标 如果vx &gt;= 0注2，跳转到目标。<br />if-gtz vx, 目标 如果vx &gt; 0注2，跳转到目标。<br />if-lez vx, 目标 如果vx &lt;= 0注2，跳转到目标。<br />!=是不等于<br />==是等于<br />&lt;=是小于等于。<br />【一】：goto 的使用<br />goto在smali 里面的应用是：无条件。<br />goto应用很广泛，各位可以看看我的很多帖子都是用goto爆破的。。<br />goto的用法；<br />在条件判断跳转前加上goto，跳向成功【我们想要的代码处！】<br />在分支判断前面加上goto跳向成功，和分支结果都可以加上goto跳向成功！<br />帖子：<br /><a href="http://jump2.bdimg.com/safecheck/index?url=x+Z5mMbGPAty4/2WxC+549drvOEA916X01qk57rKcBdbPK6/bfmCj7ZjXTif+KEE0cYymkvTRljZpZX2AajdMQA+SLi6XdcBMraHgNe6sM1wOkNGOZM13Nvew3V2Ve6RK3GNUxpf68b9ObQOfu9HoqKn97RCHOhsdj2oeHoEzTI=" target="_blank">http://www.52pojie.cn/thread-311175-1-1.html</a><br /><a href="http://jump2.bdimg.com/safecheck/index?url=x+Z5mMbGPAty4/2WxC+549drvOEA916X01qk57rKcBdbPK6/bfmCj28OK1v0WW6I0cYymkvTRljZpZX2AajdMQA+SLi6XdcBMraHgNe6sM1wOkNGOZM13Nvew3V2Ve6RK3GNUxpf68b9ObQOfu9HoqKn97RCHOhsdj2oeHoEzTI=" target="_blank">http://www.52pojie.cn/thread-306127-1-1.html</a><br />【二】：3大游戏发布平台的支付函数<br />3大游戏发布平台指的是：  <br />移动 【和游戏和MM商城】 、电信、联通 <br />【和游戏】<br />移动游戏的支付函数：<br />onBillingSuccess【onUserOperCancel和onBillingFail】<br />onResult方法【判断】<br />Sta info OK  【对应修改的地方是：Sta info fail修改为OK即可。这种比较少见】<br />移动还有部分支付函数我就不说了，<br />现在都发展到；signature和MD5 Classes校验了，学习该方面的知识，和改SO是当前比较重要的。<br />电信<br />电信爱游戏的支付函数：<br />大家应该知道，<br />game189文件夹的sms$2文件夹里，有的呢，被混淆了，<br />成了，a、b、c、d文件夹里了。但是我们发现它仍然在game189文件夹里。找到那个分支，<br />使用让第二个分支，跳向第一个跳转了。如果不是，那么就一个一个试。<br />paySuccess【payFail、payCancel】<br />这个大家就很熟悉了，这个是爱游戏现在用的最广泛的一个了，可能爱游戏正在升级单机游戏<br />的验证系统。支付函数不得而知。<br />如果升级了验证系统，那么就一定不是这个了，<br />所以，要找游戏的关键字，进行查找。<br />联通：<br />联通 沃游戏的支付函数：<br />。。。。。<br />这个我没改过它们的游戏。原因吧，还是它们网站更新的游戏太少，也不经常去。<br />各位如果想更多的了解它们的支付函数，<br />可以到吾爱破解论坛的：这里下载：<br />Android各大支付接口SDK文档&amp;DEMO共享<br /><a href="http://jump2.bdimg.com/safecheck/index?url=x+Z5mMbGPAty4/2WxC+549drvOEA916X01qk57rKcBfcIKFKsBYpcUab+PMWdE2SvPT2NtkoTNfZpZX2AajdMQA+SLi6XdcBMraHgNe6sM1wOkNGOZM13Nvew3V2Ve6RK3GNUxpf68b9ObQOfu9HoqKn97RCHOhsdj2oeHoEzTI=" target="_blank">http://www.52pojie.cn/thread-263912-1-2.html</a><br />【三】去广告通用教程<br />1、本次教大家的是最简单的，也不算最简单的。。<br />首先：去广告，你要了解它签名后，闪退与否，改了闪退，就有签名验证，<br />就得先改掉签名验证。<br />我遇到过这种的。<br />2、INTERNET权限，在AndroidManifest.xml中基本都会有这个权限，<br />我们只要删除掉这个权限，保存，然后进入游戏，测试就会提示你；ERROR<br />意思；没有声明联网权限，然后找到这句英文，改掉它的跳转即可。<br />3、第三种：比如google的广告，可以在AndroidManifest.xml中<br />删除掉 google.adactivity，同样、inmob的广告也是这种改法。保存、测试仍然提示错误，没有声明权限，<br />所以找到这句英文改跳转即可。<br />如果以上三种方法不奏效，那么最后我们就要在代码里找到<br />它的网站了，比如google广告，我们只要搜索  google.  即可找到google.网站。<br />有很多，我们让它返回空的，<br />const-string &ldquo;&rdquo;  <br />这样，就改好了。<br />帖子：<br /><a href="http://jump2.bdimg.com/safecheck/index?url=x+Z5mMbGPAty4/2WxC+549drvOEA916XsKTNhIB34h6GcDhLczjxVMBMs4AzvlD12Ngf0R/Nm7ua3FgZ307QkUsZBx5IMGscp9h/AQUluz4APki4ul3XATK2h4DXurDNcDpDRjmTNdzb3sN1dlXukStxjVMaX+vG/Tm0Dn7vR6Kip/e0QhzobHY9qHh6BM0y" target="_blank">http://www.52pojie.cn/forum.php?mod=viewthread&amp;tid=303362</a><br />【四】去积分通用教程<br />同样的，如果改了签名，闪退，软件就必须先改掉它的签名验证。现在，我见到的这样的软件有几个。技术发展。。。<br />1、去积分方法一、建议各位手机端安装：十六进制计算器.APK<br />安装后把图标放到桌面上，然后使用就方便了。<br />积分数量一般在关键字 &ldquo;积分&rdquo; 附近，所以找找就可以找到了，<br />找到后，假如需要80积分才能进入游戏，所以十六进制就是0x50<br />所以、找到以后，修改为0x0即可。<br />【提示：一般想找到自己软件的初始积分：0x0很难找，因为代码中有很多0x0、】<br />2、去积分方法二、<br />其实我们只要搜索；积分就可以找到许多可修改的地方。<br />那么我们缩短搜索范围进行搜索，我们搜索 &ldquo;不足&rdquo;<br />改掉它的跳转即可。<br />3、去积分方法三、<br />现在有一些 &ldquo;顽固分子&rdquo; &ldquo;App&rdquo;，改了积分也没用，改了跳转也没用，<br />那么，如果没有lib文件夹，又是联网获取积分。那么我们就要使用抓包了，<br />详见低调的视频教程：<br />BT种子搜索器之联网签名验证处理+去除积分墙<br /><a href="http://jump2.bdimg.com/safecheck/index?url=x+Z5mMbGPAty4/2WxC+549drvOEA916X01qk57rKcBfcIKFKsBYpcbH6WC0CDVLh0cYymkvTRljZpZX2AajdMQA+SLi6XdcBMraHgNe6sM1wOkNGOZM13Nvew3V2Ve6RK3GNUxpf68b9ObQOfu9HoqKn97RCHOhsdj2oeHoEzTI=" target="_blank">http://www.52pojie.cn/thread-262680-1-1.html</a><br />【五】我们应该如何找到游戏破解的关键位置？<br />首先我们在开始破解之前，就要收集游戏的信息，文字等等。<br />才能开始破解。<br />通过关键提示文字查找，这是一种最简单的方法。<br />一般文字都是，成功.失败，取消，对应；Success、Cancel 、Fail<br />但是也不是所有游戏都是Success、之类的。<br />那么我们应该如何定位，找到关键位置呢？<br />在我改过的游戏中，一般支付的方法，都会有  监听器。<br />监听器的英文翻译就是：Listener【listener】。所以我们可以查找该代码进行定位分析。<br />改游戏一般改跳转就可以达到破解成功！<br />比如：<br />if-eq v1 v2 label_12  【跳向成功】<br />if-ne v2 v3 label_14  【跳向失败】<br />第一种改法：<br />删掉if-ne v2 v3 label_14即可达到破解成功！<br />移动MM商城的  onBillingFinish    就是一个例子。<br />第二种改法：<br />if-eq v1 v2 label_12<br />改为goto  label_12 或者eq改为ne<br />但是if-ne v2 v3 label_14必须改为eq<br />原理各位应该知道吧？<br />这个使用的goto就是不让它判断，它就会无条件实现这里的代码，<br />然后走向实现的地方：label_12<br />根据Dalvik跳转指令。<br />【六】、如何让游戏不弹出弹窗直接购买成功的简单分析<br />如果知道游戏的 &ldquo;支付 接口&rdquo;  又知道游戏支付成功所调用的是那一句，<br />我们就可以根据这些代码，将支付成功所调用的那一句，放到 &ldquo;支付接口&rdquo;那，<br />因为路径不同。所以要改路径。<br />这样改好了以后，就可以不弹出弹窗，直接购买成功！<br />低调的视频教程中介绍了 移动MM商城  onBillingFinish 的支付接口和成功的那句代码。<br />但是各位要注意、不是所有的游戏支付接口你都能找得出来，需要时间去找。<br />【七】、如何给安卓游戏添加弹窗文字时间延长 和弹窗文字改变<br />这个想必有人知道吧。<br />不知道的就去看法总的视频教程：<br />给APK添加弹窗的三种方法。<br />我们要给游戏添加弹窗，首先就必须知道；游戏最先启动的第一个activity<br />的onCreate方法。<br />只能在这个方法开头添加才能成功弹出！<br />否则闪退。<br />如何让文字改变   如何让弹窗的文字时间延长一点？<br />下面看一段代码：【这段代码就是法总视频教程中的那段代码】<br />    const-string v0, "游戏已破解"<br />    const/4 v1, 0x1<br />
    invoke-static {p0, v0, v1}, 
Landroid/widget/Toast;-&gt;makeText(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast;<br />    move-result-object v0<br />    invoke-virtual {v0}, Landroid/widget/Toast;-&gt;show()V<br />    const-string v0, "游戏已破解"<br />    const/4 v1, 0x1<br />
    invoke-static {p0, v0, v1}, 
Landroid/widget/Toast;-&gt;makeText(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast;<br />    move-result-object v0<br />    invoke-virtual {v0}, Landroid/widget/Toast;-&gt;show()V<br />    const-string v0, "已破解"<br />    const/4 v1, 0x1<br />
    invoke-static {p0, v0, v1}, 
Landroid/widget/Toast;-&gt;makeText(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast;<br />    move-result-object v0<br />    invoke-virtual {v0}, Landroid/widget/Toast;-&gt;show()V<br />各位应该看到了吧？为什么会有三段代码？各位应该发现。三段代码都是一样的。只是文字不一样。<br />我们把这3端代码放到启动的第一个activity的onCreate方法下。它就会运行这里的代码。<br />运行三段这样的代码，时间就会有所延长，<br />这就是添加弹窗的文字修改和时间延长！<br />各位应该听懂了吧？也就是100段相同的这样的代码。放到启动的第一个activity的onCreate<br />方法下。<br />它启动的时候就运行这里，一直往下运行。代码没完毕它就会一直显示。<br />这就是  &ldquo;弹窗&rdquo;的  举一反三。<br />【八】、反编译成功，回编译失败怎么办？<br />要么软件是对DEX处理过的，不让你回编译。<br />要么是回编译软件出问题，还是代码文件缺少出的问题。<br />比如APK IDE改之理  回编译签名后，会破解软件本身的文件。<br />如果不是对dex处理的。那么我们就可以<br />使用 上上签  签名工具  将DEX拖出来，签名。<br />也可以使用APK  DB   ，同样，将dex拖出来，回编译。这里我推荐这一款工具，<br />因为安装后，支持对APK 、DEX右键 反编译、回编译、的功能。<br />非常方便。<br />如果回编译DEX失败，那么软件对DEX就做了一定的处理。<br />完结篇：<br />在这里，我要推荐改SO工具；  010  Editor   该工具可以直接载入SO文件。<br />以十六进制模式展示。<br />xml文件中的id   0x279f00c2433之类的，都是以十六进制展示的，<br />所以，在必要时，我们把它转为十进制，打开JAVA源码查找。<br />＋<br />＋<br />手机端我要推荐使用的工具是：<br />APK解包打包工具<br />十六进制编辑器<br />十六进制计算器<br />MT管理器<br />Dalvik字节码编辑器<br />应用备份和还原<br />非常轻巧，内存小的备份软件，假如程序自动删除了软件包，<br />那么可以使用它备份。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>1.首先要知道的是：<br />
内购关键词：<br />
和游戏搜索方法名<br />
onResult，onchinabilling，resulton，Paycenter，Callback<br />
联通游戏搜索方法名<br />
OnPayResult，PyaResulton，Activity，result，callback<br />
电信爱游戏搜索方法名<br />
paySuccess成功，payCancel取消，payFailed失败<br />
移动mm搜索方法名<br />
onBillingFinish，Billing，CallBack<br />
支付宝和银行卡方法名<br />
handle，message<br />
支付宝搜索字符:9000<br />
360支付<br />
onfinishedon，Activityresult<br />
发送短信上限:android.permission.SEND_SMS<br />
发送短信锁定支付式关建字符串</p>